<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CashPal Loan</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
<style>
  body {
    font-family: 'Poppins', sans-serif;
    margin:0;
    padding:0;
    background: linear-gradient(120deg,#0f0c29,#302b63,#24243e);
    color:#fff;
  }
  header {
    background: rgba(10,10,10,0.8);
    backdrop-filter: blur(10px);
    padding:20px;
    text-align:center;
    font-size:1.8em;
    color:#00f0ff;
    text-shadow:0 0 10px #00f0ff;
  }
  section {
    padding:50px 20px;
    max-width:600px;
    margin: 40px auto;
    background: rgba(10,10,10,0.6);
    backdrop-filter: blur(10px);
    border-radius:20px;
    box-shadow:0 0 30px #00f0ff77,0 0 60px #ff3d8177 inset;
    opacity:0;
    transform: translateY(50px);
    transition: all 1s ease-out;
  }
  section.visible {
    opacity:1;
    transform: translateY(0);
  }
  input, select {
    width:80%;
    padding:12px;
    margin:10px 0;
    border-radius:10px;
    border:none;
    outline:none;
    text-align:center;
    background:#111;
    color:#00f0ff;
    box-shadow:0 0 10px #00f0ff;
  }
  input:focus {
    box-shadow:0 0 20px #ff3d81;
  }
  button {
    padding:15px 35px;
    border:none;
    border-radius:50px;
    font-weight:600;
    font-size:1.1em;
    background: linear-gradient(90deg,#00f0ff,#ff3d81);
    color:#fff;
    cursor:pointer;
    box-shadow:0 0 20px #00f0ff,0 0 40px #ff3d81 inset;
    transition:0.3s;
    animation: glowPulse 2s infinite alternate;
  }
  button:hover {
    transform: scale(1.05);
  }
  @keyframes glowPulse {
    0% {box-shadow:0 0 20px #00f0ff,0 0 40px #ff3d81 inset;}
    50% {box-shadow:0 0 30px #ff3d81,0 0 60px #00f0ff inset;}
    100% {box-shadow:0 0 20px #00f0ff,0 0 40px #ff3d81 inset;}
  }
  #status {
    margin-top:15px;
    font-size:1.2em;
    color:#ff3d81;
    text-shadow:0 0 5px #ff3d81;
  }
</style>
</head>
<body>

<header>CashPal - Fast Loans</header>

<!-- Step 1: Phone + OTP -->
<section id="otpSection">
  <h2>Verify Your Phone</h2>
  <input type="number" id="phone" placeholder="Enter your phone number"><br>
  <button onclick="sendOTP()">Send OTP</button>
  <div id="otpInput" style="display:none; margin-top:15px;">
    <input type="number" id="otp" placeholder="Enter OTP"><br>
    <button onclick="verifyOTP()">Verify OTP</button>
  </div>
</section>

<!-- Step 2: Loan Application -->
<section id="loanSection" style="display:none;">
  <h2>Apply for a Loan</h2>
  <label>Loan Amount (¢500 - ¢3000)</label><br>
  <input type="number" id="loanAmount" min="500" max="3000" value="500"><br>
  <p>Down Payment (10%): ¢<span id="downPayment">50</span></p>

  <input type="text" id="name" placeholder="Full Name"><br>
  <input type="email" id="email" placeholder="Email"><br>
  <label>Have you taken a loan before?</label><br>
  <select id="prevLoan">
    <option value="No">No</option>
    <option value="Yes">Yes</option>
  </select><br>

  <p>Repayment period: <strong>1 month 2 weeks</strong></p>

  <button onclick="payDownPayment()">Pay Down Payment</button>
  <div id="status"></div>
</section>

<script src="https://js.paystack.co/v1/inline.js"></script>
<script>
  // OTP Logic
  let generatedOTP;
  function sendOTP(){
    const phone = document.getElementById('phone').value;
    if(phone.length < 9){
      alert('Enter a valid phone number');
      return;
    }
    generatedOTP = Math.floor(100000 + Math.random() * 900000);
    alert('OTP sent: ' + generatedOTP); // For demo only
    document.getElementById('otpInput').style.display = 'block';
  }

  function verifyOTP(){
    const enteredOTP = document.getElementById('otp').value;
    if(enteredOTP == generatedOTP){
      alert('Phone verified!');
      document.getElementById('otpSection').style.display = 'none';
      document.getElementById('loanSection').style.display = 'block';
      updateDownPayment();
    } else {
      alert('Incorrect OTP. Try again.');
    }
  }

  // Update 10% down payment dynamically
  document.getElementById('loanAmount').addEventListener('input', updateDownPayment);
  function updateDownPayment(){
    const amount = parseFloat(document.getElementById('loanAmount').value);
    const down = (amount * 0.10).toFixed(2);
    document.getElementById('downPayment').innerText = down;
  }

  // Paystack Down Payment with mailto
  function payDownPayment(){
    const amount = parseFloat(document.getElementById('loanAmount').value);
    if(amount < 500 || amount > 3000){
      alert('Loan amount must be between ¢500 and ¢3000');
      return;
    }
    const downPayment = amount * 0.10;
    const name = document.getElementById('name').value;
    const email = document.getElementById('email').value;
    const phone = document.getElementById('phone').value;
    const prevLoan = document.getElementById('prevLoan').value;

    if(!name || !email){
      alert('Please enter your name and email');
      return;
    }

    let handler = PaystackPop.setup({
      key: 'pk_live_286cc49774695e4f691de3d8eab1d44aa191a7ac',
      email: email,
      amount: downPayment * 100,
      currency: 'GHS',
      channels: ['mobile_money'],
      ref: 'CASHPAL_' + Math.floor(Math.random() * 1000000000 + 1),
      callback: function(response){
        document.getElementById('status').innerText = "Down payment received. Reviewing your loan request. An email has been sent to admin.";

        // Send email to your normal email
        const subject = encodeURIComponent("New CashPal Loan Request");
        const body = encodeURIComponent(
          `Customer Name: ${name}\n` +
          `Customer Email: ${email}\n` +
          `Phone: ${phone}\n` +
          `Loan Amount: ¢${amount}\n` +
          `Previous Loan: ${prevLoan}\n` +
          `Paystack Reference: ${response.reference}`
        );
        window.location.href = ebbahemmanuel98@gmail.com?subject=${subject}&body=${body}`;
      },
      onClose: function(){
        alert('Payment cancelled');
      }
    });
    handler.openIframe();
  }

  // Fade-in sections on scroll
  const observer = new IntersectionObserver(entries => {
    entries.forEach(entry => {
      if(entry.isIntersecting){
        entry.target.classList.add('visible');
      }
    });
  }, { threshold: 0.2 });

  document.querySelectorAll('section').forEach(el => observer.observe(el));
</script>

</body>
</html>
